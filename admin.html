<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HOTEP | Ultimate Admin 2026</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

    <style>
        :root { --gold: #D4AF37; --black: #000; --dark: #0a0a0a; --green: #25d366; --blue: #0084ff; --red: #d9534f; --orange: #ff8c00; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--black); color: #fff; margin: 0; padding: 0; overflow-x: hidden; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ø­Ù…Ø§ÙŠØ© Ù…Ø·Ù„Ù‚Ø© ÙˆØªÙ†Ø³ÙŠÙ‚ ÙØ®Ù… */
        #login-screen { position: fixed; inset: 0; background: var(--black); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 999999; }
        .login-box { width: 90%; max-width: 360px; text-align: center; padding: 45px 30px; border-radius: 35px; background: #050505; border: 1px solid #1a1a1a; box-shadow: 0 0 50px rgba(0,0,0,1); }
        .login-box h1 { color: var(--gold); font-size: 38px; margin: 0; letter-spacing: 5px; font-weight: 900; }
        .login-box p { color: #333; font-size: 10px; margin-bottom: 35px; letter-spacing: 2px; }
        .login-box input { width: 100%; padding: 16px; border-radius: 12px; border: 1px solid #222; background: #000; color: var(--gold); text-align: center; font-size: 20px; outline: none; margin-bottom: 20px; }
        .login-box input:focus { border-color: var(--gold); }
        .login-box button { width: 100%; padding: 16px; border-radius: 12px; border: none; background: var(--gold); color: #000; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.2s; }
        .login-box button:active { transform: scale(0.96); }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        #admin-content { display: none; }

        .header-stats { background: #080808; padding: 25px 15px; display: flex; justify-content: space-around; border-bottom: 1px solid #111; position: sticky; top: 0; z-index: 100; }
        .stat-card { text-align: center; }
        .stat-card span { display: block; font-size: 10px; color: var(--gold); opacity: 0.7; margin-bottom: 4px; }
        .stat-card b { font-size: 22px; font-weight: 800; }

        .tabs-bar { display: flex; background: #050505; margin: 15px; border-radius: 18px; border: 1px solid #111; overflow: hidden; }
        .tab-btn { flex: 1; padding: 16px; border: none; background: transparent; color: #444; cursor: pointer; font-size: 12px; font-weight: bold; }
        .tab-btn.active { background: var(--gold); color: #000; }

        .tab-content { padding: 0 15px 40px; display: none; }
        .tab-content.active { display: block; }

        /* ÙƒØ§Ø±Øª Ø§Ù„Ø£ÙˆØ±Ø¯Ø± Ø§Ù„Ù…Ù†Ø³Ù‚ */
        .order-card { background: #080808; border-radius: 25px; padding: 22px; margin-bottom: 15px; border: 1px solid #151515; border-right: 5px solid var(--gold); position: relative; }
        .price-text { position: absolute; left: 20px; top: 22px; color: var(--green); font-weight: 800; font-size: 22px; }
        .cust-name { font-size: 18px; font-weight: bold; display: block; margin-bottom: 6px; color: #fff; }
        .cust-qty { background: rgba(212,175,55,0.1); color: var(--gold); padding: 4px 10px; border-radius: 8px; font-size: 11px; font-weight: bold; }
        .cust-details { font-size: 13px; color: #666; margin-top: 15px; line-height: 1.6; }

        .btn-flex { display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
        .btn-act { flex: 1; height: 46px; border-radius: 12px; border: none; color: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; text-decoration: none; }
        .b-ship { background: #4d2dff; font-weight: bold; }
        .b-done { background: var(--blue); font-weight: bold; }
        .b-copy { background: var(--orange); }
        .b-wa { background: var(--green); }
        .b-del { background: #151515; color: var(--red); flex: 0 0 46px; }

        .excel-btn-full { width: calc(100% - 30px); margin: 0 15px 15px; padding: 15px; background: #1d6f42; color: #fff; border: none; border-radius: 15px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
    </style>
</head>
<body>

    <audio id="notifSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

    <div id="login-screen">
        <div class="login-box">
            <h1>HOTEP</h1>
            <p>ELITE MANAGEMENT SYSTEM</p>
            <input type="password" id="passInput" placeholder="Passcode" onkeypress="if(event.key==='Enter') login()">
            <button onclick="login()">ENTER SYSTEM</button>
        </div>
    </div>

    <div id="admin-content">
        <div class="header-stats">
            <div class="stat-card"><span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</span><b id="m_profit">0</b></div>
            <div class="stat-card"><span>Ø§Ù„Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</span><b id="m_sold">0</b></div>
        </div>

        <div class="tabs-bar">
            <button class="tab-btn active" onclick="switchTab(event, 't1')">Ø¬Ø¯ÙŠØ¯ (<span id="count1">0</span>)</button>
            <button class="tab-btn" onclick="switchTab(event, 't2')">Ù…Ø´Ø­ÙˆÙ† (<span id="count2">0</span>)</button>
            <button class="tab-btn" onclick="switchTab(event, 't3')">Ù…ÙƒØªÙ…Ù„ (<span id="count3">0</span>)</button>
        </div>

        <div id="t1" class="tab-content active"><div id="list1"></div></div>
        <div id="t2" class="tab-content">
            <button class="excel-btn-full" onclick="downloadExcel()">
                <i class="fas fa-file-excel"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙƒØ´Ù Ø§Ù„Ø´Ø­Ù† (Excel)
            </button>
            <div id="list2"></div>
        </div>
        <div id="t3" class="tab-content"><div id="list3"></div></div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        let db;
        let lastSize = -1;
        let excelData = [];

        function login() {
            if (document.getElementById('passInput').value === "hero1") {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('admin-content').style.display = 'block';
                init();
            } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©"); }
        }

        function switchTab(e, id) {
            let contents = document.getElementsByClassName("tab-content");
            for (let c of contents) c.style.display = "none";
            let btns = document.getElementsByClassName("tab-btn");
            for (let b of btns) b.classList.remove("active");
            document.getElementById(id).style.display = "block";
            e.currentTarget.classList.add("active");
        }

        function init() {
            const config = { databaseURL: "https://hotep-f423e-default-rtdb.europe-west1.firebasedatabase.app/" };
            if (!firebase.apps.length) firebase.initializeApp(config);
            db = firebase.database();

            db.ref('orders').on('value', snap => {
                let html = { t1:'', t2:'', t3:'' };
                let c = { t1:0, t2:0, t3:0 };
                let profit = 0; let items = 0;
                excelData = [];

                if (lastSize !== -1 && snap.numChildren() > lastSize) {
                    document.getElementById('notifSound').play().catch(()=>{});
                }
                lastSize = snap.numChildren();

                snap.forEach(child => {
                    const o = child.val();
                    const id = child.key;
                    
                    let qty = parseInt(String(o.Ø§Ù„ÙƒÙ…ÙŠØ© || "1").replace(/[^0-9]/g, '')) || 1;
                    let g = o.Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
                    let ship = (g.includes("Ù‚Ø§Ù‡Ø±Ø©") || g.includes("Ø¬ÙŠØ²Ø©")) ? 50 : 70;
                    let total = (qty * 200) + ship;
                    let sz = o.Ø§Ù„Ù…Ù‚Ø§Ø³ || 'M';

                    if(o.Ø§Ù„Ø­Ø§Ù„Ø© === 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…') { profit += (qty * 200); items += qty; }

                    // Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„
                    const copyBody = `HOTEP ORDER\nØ§Ù„Ø§Ø³Ù…: ${o.Ø§Ù„Ø§Ø³Ù…}\nØ§Ù„Ù‡Ø§ØªÙ: ${o.Ø§Ù„Ù‡Ø§ØªÙ}\nØ§Ù„Ø¹Ù†ÙˆØ§Ù†: ${g} - ${o.Ø§Ù„Ø¹Ù†ÙˆØ§Ù†}\nØ§Ù„Ù…Ù‚Ø§Ø³: ${sz}\nØ§Ù„Ø¹Ø¯Ø¯: ${qty}\nØ§Ù„Ø­Ø³Ø§Ø¨: ${total}Ø¬`;
                    const waBody = `Ø£Ù‡Ù„Ø§Ù‹ Ø£/ ${o.Ø§Ù„Ø§Ø³Ù…} âœ¨\nØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ Ù…Ù† Ø¨Ø±Ø§Ù†Ø¯ HOTEP âœ…\n\nØ§Ù„ØªÙØ§ØµÙŠÙ„:\nğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: Ø¹Ø¯Ø¯ (${qty}) Ø¹Ù„Ø¨Ø©\nğŸ“ Ø§Ù„Ù…Ù‚Ø§Ø³: ${sz}\nğŸ’° Ø§Ù„Ø­Ø³Ø§Ø¨: ${total} Ø¬Ù†ÙŠÙ‡ (Ø´Ø§Ù…Ù„ Ø§Ù„Ø´Ø­Ù†)\n\nÙ†Ø´ÙƒØ±Ùƒ Ø¹Ù„Ù‰ Ø«Ù‚ØªÙƒ Ø¨Ù†Ø§!`;

                    const card = `
                        <div class="order-card">
                            <div class="price-text">${total}Ø¬</div>
                            <span class="cust-name">${o.Ø§Ù„Ø§Ø³Ù…}</span>
                            <span class="cust-qty">${qty} Ø¹Ù„Ø¨Ø© - ${sz}</span>
                            <div class="cust-details">
                                <i class="fas fa-phone"></i> ${o.Ø§Ù„Ù‡Ø§ØªÙ}<br>
                                <i class="fas fa-map-marker-alt"></i> ${g} - ${o.Ø§Ù„Ø¹Ù†ÙˆØ§Ù†}
                            </div>
                            <div class="btn-flex">
                                ${o.Ø§Ù„Ø­Ø§Ù„Ø© === 'Ù…Ø´Ø­ÙˆÙ†' ? 
                                    `<button onclick="setStat('${id}','ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…')" class="btn-act b-done">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</button>` : 
                                    (o.Ø§Ù„Ø­Ø§Ù„Ø© === 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…' ? `<div style="width:100%;text-align:center;color:var(--green);font-weight:bold;font-size:12px;padding:10px">âœ… Ù…ÙƒØªÙ…Ù„</div>` : `<button onclick="setStat('${id}','Ù…Ø´Ø­ÙˆÙ†')" class="btn-act b-ship">Ø´Ø­Ù†</button>`)
                                }
                                <button onclick="copyToClipboard(\`${copyBody}\`)" class="btn-act b-copy"><i class="fas fa-copy"></i></button>
                                <a href="https://wa.me/2${o.Ø§Ù„Ù‡Ø§ØªÙ}?text=${encodeURIComponent(waBody)}" target="_blank" class="btn-act b-wa"><i class="fab fa-whatsapp"></i></a>
                                <button onclick="del('${id}')" class="btn-act b-del"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>`;

                    if(o.Ø§Ù„Ø­Ø§Ù„Ø© === 'Ù…Ø´Ø­ÙˆÙ†') { 
                        html.t2 += card; c.t2++; 
                        excelData.push({"Ø§Ù„Ø§Ø³Ù…":o.Ø§Ù„Ø§Ø³Ù…, "Ø§Ù„Ù‡Ø§ØªÙ":o.Ø§Ù„Ù‡Ø§ØªÙ, "Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©":g, "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":o.Ø§Ù„Ø¹Ù†ÙˆØ§Ù†, "Ø§Ù„ÙƒÙ…ÙŠØ©":qty, "Ø§Ù„Ù…Ù‚Ø§Ø³":sz, "Ø§Ù„Ø­Ø³Ø§Ø¨":total});
                    }
                    else if(o.Ø§Ù„Ø­Ø§Ù„Ø© === 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…') { html.t3 += card; c.t3++; }
                    else { html.t1 += card; c.t1++; }
                });

                document.getElementById('list1').innerHTML = html.t1 || '<p style="text-align:center;color:#222;margin-top:40px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙˆØ±Ø¯Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</p>';
                document.getElementById('list2').innerHTML = html.t2;
                document.getElementById('list3').innerHTML = html.t3;
                document.getElementById('m_profit').innerText = profit.toLocaleString();
                document.getElementById('m_sold').innerText = items;
                document.getElementById('count1').innerText = c.t1;
                document.getElementById('count2').innerText = c.t2;
                document.getElementById('count3').innerText = c.t3;
            });
        }

        window.setStat = (id, s) => db.ref('orders/'+id).update({ Ø§Ù„Ø­Ø§Ù„Ø©: s });
        window.del = (id) => { if(confirm('Ø­Ø°ÙØŸ')) db.ref('orders/'+id).remove(); };
        window.copyToClipboard = (txt) => {
            navigator.clipboard.writeText(txt).then(() => alert("ØªÙ… Ù†Ø³Ø® Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ âœ…"));
        };

        function downloadExcel() {
            if(excelData.length === 0) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª");
            const ws = XLSX.utils.json_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "HotepOrders");
            XLSX.writeFile(wb, "Hotep_Orders_2026.xlsx");
        }
    </script>
</body>
</html>
 
